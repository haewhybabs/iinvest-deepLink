<!DOCTYPE html>
<html>
    <head>
    <title>iOS Automatic Deep Linking</title>
    </head>
    <body>
        <script>
            (function() {
                const iOS = !!navigator.platform && /iPad|iPhone|iPod/.test(navigator.platform);
                var storeUrl=iOS?'https://apps.apple.com/ng/app/i-invest/id1381126486':'https://play.google.com/store/apps/details?id=com.cousant.naijainvest';
                
                var now = new Date().valueOf();
                setTimeout(function () {
                // time stamp comaprison prevents redirecting to app store a 2nd time
                if (new Date().valueOf() - now > 100) {
                    window.close() ;  // scenario #4
                    // old way - "return" - but this would just leave a blank page in users browser
                    //return;  
                }
                if (iOS == 1) {
                    // still can't avoid the "invalid address" safari pops up
                    // but at least we can explain it to users
                    var msg = "i-invest not installed.\n\nREDIRECTING TO APP STORE" ;
                } else {
                    var msg = "MyApp NOT DETECTED\n\nREDIRECTING TO APP STORE" ;
                }
                if (window.confirm(msg)) {
                    window.location = storeUrl;
                    // scenario #2 - will leave a blank tab in browser
                } else {
                    window.close() ;  // scenario #3
                }
                }, 50);
                window.location = 'iinvest://';  
                })();
        </script>
    </body>

</html>
